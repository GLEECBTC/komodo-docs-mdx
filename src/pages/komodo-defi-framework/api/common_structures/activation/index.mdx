export const title = "Komodo DeFi SDK Common Structures: Activation";
export const description = "The Komodo DeFi SDK uses a variety of activation methods, depending on the type of coin.";

import CompactTable from '@/components/CompactTable';

# Activation Common Structures

## activation\_common\_structures {{label : 'activation_common_structures', tag : 'structures'}}

### ActivationMode

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  Defines the activation mode for QTUM, BCH, UTXO & ZHTLC coins.

  <CompactTable
    data={[
      {
        parameter: "rpc",
        type: "string",
        required: true,
        description: "`Native` if running a native blockchain node, `Electrum` if using electrum servers or `Light` for ZHTLC coins."
      },
      {
        parameter: "rpc_data",
        type: "object",
        required: false,
        description: "Optional. `Electrum` or `Light` mode only. A standard [ActivationRpcData](/komodo-defi-framework/api/common_structures/activation/#activation-rpc-data) object."
      }
    ]}
  />

  ```json
  {
      "mode": {
          "rpc": "Electrum",
          "rpc_data": {
              "servers": [
                  {
                      "url": "electrum1.cipig.net:10020"
                  },
                  {
                      "url": "electrum2.cipig.net:10020"
                  }
              ]
          }
      },
  }
  ```
</CollapsibleSection>

### ActivationRpcData

Contains information about electrum & lightwallet\_d servers for coins being used in `Electrum` or `Light` mode.

<CompactTable
  data={[
    {
      parameter: "light_wallet_d_servers",
      type: "list",
      required: false,
      description: "Optional. ZHTLC only. A list of urls which are hosting lightwallet_d servers for a coin."
    },
    {
      parameter: "electrum_servers",
      type: "list of objects",
      required: false,
      description: "Optional. ZHTLC only. A list of standard [ActivationServers](/komodo-defi-framework/api/common_structures/activation/#activation-servers) objects."
    },
    {
      parameter: "electrum",
      type: "list of objects",
      required: false,
      description: "Optional. QTUM, BCH & UTXO coins only. A list of standard [ActivationServers](/komodo-defi-framework/api/common_structures/activation/#activation-servers) objects."
    },
    {
      parameter: "sync_params",
      type: "integer or string",
      required: false,
      default: "2 days ago",
      description: "Optional, defaults to `2 days ago`. ZHTLC coins only. Defines where to start scanning blockchain data upon initial activation. Options: `\"earliest\"` (the coin's sapling_activation_height), `height` (a specific block height) or `date` (a unix timestamp)."
    }
  ]}
/>

<DevComment>
  `electrum` and `electrum_servers` are both used for the same purpose. This should be consolidated in the API.
</DevComment>

### ActivationParams

The `ActivationParams` object defines additional parameters used for activation. These params may vary depending on the coin type.

<CompactTable
  variant="compact"
  data={[
    {
      parameter: "required_confirmations",
      type: "integer",
      required: false,
      description: "Optional. Confirmations to wait for steps in swap. Defaults to value in the coins file if not set."
    },
    {
      parameter: "requires_notarization",
      type: "boolean",
      required: false,
      default: "false",
      description: "Optional, defaults to `false`. For [dPoW](https://komodoplatform.com/en/blog/dpow-demystified/) protected coins, a `true` value will wait for transactions to be notarised when doing swaps. Overrides value if set in `coins` file."
    },
    {
      parameter: "mode",
      type: "object",
      required: false,
      description: "Optional. QTUM, UTXO & ZHTLC coins only. A standard [ActivationMode](/komodo-defi-framework/api/common_structures/activation/#activation-mode) object."
    },
    {
      parameter: "zcash_params_path",
      type: "string",
      required: false,
      description: "Optional. ZHTLC coins only. Path to folder containing [Zcash parameters](https://z.cash/learn/). Defaults to standard location as defined in [this guide](https://forum.komodoplatform.com/t/installing-zcash-params/603)"
    },
    {
      parameter: "scan_blocks_per_iteration",
      type: "integer",
      required: false,
      default: "1000",
      description: "Optional, defaults to `1000`. ZHTLC coins only. Sets the number of scanned blocks per iteration during `BuildingWalletDb` state."
    },
    {
      parameter: "scan_interval_ms",
      type: "integer",
      required: false,
      default: "0",
      description: "Optional, defaults to `0`. ZHTLC coins only. Sets the interval in milliseconds between iterations of `BuildingWalletDb` state."
    },
    {
      parameter: "tx_history",
      type: "boolean",
      required: false,
      description: "Optional. Enable transaction history scanning. When active, the Komodo DeFi Framework API will collect transaction history data for local storage, and allow use of the [my_tx_history (v2)](/komodo-defi-framework/api/v20/wallet/tx/my_tx_history/) method."
    },
    {
      parameter: "min_addresses_number",
      type: "integer",
      required: false,
      description: "Optional. HD wallets only. Number of addresses to generate. If not specified, addresses will be generated up to `path_to_address::address_index`."
    },
    {
      parameter: "scan_policy",
      type: "string",
      required: false,
      default: "scan_if_new_wallet",
      description: "Optional, defaults to `scan_if_new_wallet`. HD wallets only. Whether or not to scan for new addresses. Select from `do_not_scan`, `scan_if_new_wallet` or `scan`. Note that `scan` will result in multple requests to the Komodo DeFi API and may take some time to complete."
    },
    {
      parameter: "gap_limit",
      type: "integer",
      required: false,
      default: "20",
      description: "Optional, defaults to `20`. HD wallets only. The max number of empty addresses in a row. Transactions sent to an address outside the `gap_limit`, will not be identified when scanning."
    },
    {
      parameter: "path_to_address",
      type: "object",
      required: false,
      description: "Optional. HD wallets only. A standard [AddressPath](/komodo-defi-framework/api/common_structures/wallet/#address-path) object."
    },
    {
      parameter: "get_balances",
      type: "boolean",
      required: false,
      default: "true",
      description: "Optional, defaults to `true`. If `false`, coin and token balances will not be returned in the response, and the response will be returned more quickly."
    }
  ]}
/>

<DevComment>
  Is priv\_key\_policy still a thing?
  Defaults to `ContextPrivKey`. Set as `Trezor` to activate in Trezor mode.
</DevComment>

<Note>
  For ZHTLC coins, older wallets need to set the `sync_params` field to a date before its
  first transaction to see all balance and history. This may take a long time on the first
  activation, but subsequent activations will be much faster.
  Using a smaller `scan_blocks_per_iteration` and larger `scan_interval_ms`,
  will reduce the average CPU load during ZHTLC coin activation (at the cost of a
  longer activation time). These optional fields are recommended when developing
  for iOS, where a high CPU load may kill the activation process. Android &
  desktop operating systems do not appear to have any problems with high CPU
  load during ZHTLC coin activation.
</Note>

### ActivationServers

Contains information electrum servers for coins being used in `Electrum` or `Light` mode.

<CompactTable
  data={[
    {
      parameter: "url",
      type: "string",
      required: true,
      description: "The URL and port for an electrum server."
    },
    {
      parameter: "ws_url",
      type: "string",
      required: false,
      description: "Optional. For WSS only. The URL and port for an electrum server's WSS port."
    },
    {
      parameter: "protocol",
      type: "string",
      required: false,
      default: "TCP",
      description: "Optional, defaults to `TCP`. Transport protocol used to connect to the server. Options: `TCP` or `SSL`"
    },
    {
      parameter: "disable_cert_verification",
      type: "boolean",
      required: false,
      default: "false",
      description: "Optional, defaults to `false`. If `true`, this disables server SSL/TLS certificate verification (e.g. for self-signed certificates). **Use at your own risk!**"
    }
  ]}
/>

<CollapsibleSection expandedText="Hide Examples" collapsedText="Show Examples">
  #### ZHTLC Example

  ```json
  {
    "activation_params": {
      "mode": {
        "rpc": "Light",
        "rpc_data": {
          "electrum_servers": [
            {
              "url":"zombie.dragonhound.info:10133"
            }
          ],
          "light_wallet_d_servers": [
            "http://zombie.dragonhound.info:1443"
          ]
        },
        "sync_params": { 
            "height":  2528700
        }
      },
      "zcash_params_path": "/home/username/path_to/.zcash-params",
      "scan_blocks_per_iteration": 100,
      "scan_interval_ms": 200
    }
  }
  ```

  #### HD UTXO Activation (v2)

  ```json
  {
  "activation_params": {
      "mode": {
          "rpc": "Electrum",
          "rpc_data": {
              "servers": [
                  {
                      "url": "electrum2.cipig.net:10001"
                  },
                  {
                      "url": "electrum3.cipig.net:20001",
                      "ws_url": "electrum3.cipig.net:30001",
                      "protocol": "SSL"
                  }
              ]
          }
      },
      "scan_policy": "scan_if_new_wallet",
      "priv_key_policy": {"type": "Trezor"},
      "min_addresses_number": 3,
      "gap_limit": 20
  }
  }
  ```
</CollapsibleSection>

### AddressInfo

The `AddressInfo` object includes the following items for a given address:

<CompactTable
  data={[
    {
      parameter: "balances",
      type: "object",
      required: false,
      description: "Optional. A standard [BalanceInfo](/komodo-defi-framework/api/common_structures/wallet/#balance-info) object. Not included in responses where `get_balances` is `false`"
    },
    {
      parameter: "derivation_method",
      type: "object",
      required: true,
      description: "A standard [DerivationMethod](/komodo-defi-framework/api/common_structures/wallet/#derivation-method) object"
    },
    {
      parameter: "pubkey",
      type: "string",
      required: true,
      description: "The public key associated with the seed used to launch Komodo DeFi Framework"
    },
    {
      parameter: "tickers",
      type: "array",
      required: false,
      description: "Optional. A list of tokens which were successfully activated. Only included in responses where `get_balances` is `false`"
    }
  ]}
/>

<CollapsibleSection expandedText="Hide Examples" collapsedText="Show Examples">
  #### Example with balances

  ```json
  "bitcoincash:qrf5vpn78s7rjexrjhlwyzzeg7gw98k7t5qx64fztj": {
      "derivation_method": {
          "type": "Iguana"
      },
      "pubkey": "036879df230663db4cd083c8eeb0f293f46abc460ad3c299b0089b72e6d472202c",
      "balances": {
          "spendable": "0.11398301",
          "unspendable": "0.00001"
      }
  }
  ```

  #### Example without balances

  ```json
  "bitcoincash:qrf5vpn78s7rjexrjhlwyzzeg7gw98k7t5qx64fztj": {
      "derivation_method": {
          "type": "Iguana"
      },
      "pubkey": "036879df230663db4cd083c8eeb0f293f46abc460ad3c299b0089b72e6d472202c",
      "tickers": ["ASLP-SLP"]
  }
  ```
</CollapsibleSection>

### CoinProtocol

<CompactTable
  data={[
    {
      parameter: "type",
      type: "integer",
      required: true,
      description: "One of the Coin Types supported by the Komodo DeFi Framework"
    },
    {
      parameter: "protocol_data",
      type: "object",
      required: true,
      description: "A standard [CoinProtocolData](/komodo-defi-framework/api/common_structures/activation/#coin-protocol-data) object."
    }
  ]}
/>

### CoinProtocolData

<CompactTable
  data={[
    {
      parameter: "platform",
      type: "string",
      required: true,
      description: "Indicates the platform parent coin for EMV-like protocols, or the coin used for lightning nodes."
    },
    {
      parameter: "network",
      type: "string",
      required: true,
      description: "Either `mainnet` or `testnet`"
    },
    {
      parameter: "confirmation_targets",
      type: "object",
      required: true,
      description: "A standard [ConfirmationTargets](/komodo-defi-framework/api/common_structures/lightning/#confirmation-targets) object."
    }
  ]}
/>

### CoinNode

The `CoinNode` object includes the following items for a given coin or token:

<CompactTable
  data={[
    {
      parameter: "url",
      type: "string",
      required: true,
      description: "URL of an RPC node"
    },
    {
      parameter: "komodo_auth",
      type: "boolean",
      required: false,
      default: "false",
      description: "Optional, defaults to `false`. Must be set to `true` to access RPC nodes run behind [komodo-defi-proxy](https://github.com/KomodoPlatform/komodo-defi-proxy)"
    }
  ]}
/>

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  ```json
  {
      "url": "https://nucleus-rpc.alpha.komodo.earth",
      "komodo_proxy": true
  }
  ```
</CollapsibleSection>

### SwapV2Contracts

The `SwapV2Contracts` object includes the following items for a given coin or token:

<CompactTable
  data={[
    {
      parameter: "maker_swap_v2_contract",
      type: "string",
      required: true,
      description: "Address for the maker's new V2 swap smart contract. Must be provided if \"use_trading_proto_v2\"is true in your [MM2.json file](/komodo-defi-framework/setup/configure-mm2-json/) configuration"
    },
    {
      parameter: "taker_swap_v2_contract",
      type: "string",
      required: true,
      description: "Address for the taker's new V2 swap smart contract. Must be provided if \"use_trading_proto_v2\"is true in your [MM2.json file](/komodo-defi-framework/setup/configure-mm2-json/) configuration"
    },
    {
      parameter: "nft_maker_swap_v2_contract",
      type: "string",
      required: true,
      description: "Address for the maker's new V2 NFT swap smart contract. Must be provided if \"use_trading_proto_v2\"is true in your [MM2.json file](/komodo-defi-framework/setup/configure-mm2-json/) configuration"
    }
  ]}
/>

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  ```json
  {
        "maker_swap_v2_contract": "0x9130b257D37A52E52F21054c4DA3450c72f595CE",
        "taker_swap_v2_contract": "0x9130b257D37A52E52F21054c4DA3450c72f595CE",
        "nft_maker_swap_v2_contract": "0x9130b257D37A52E52F21054c4DA3450c72f595CE"
  }
  ```
</CollapsibleSection>

### TokenActivationParams

Standard object structure used in token activation methods for specifying activation parameters.

<CompactTable
  data={[
    {
      parameter: "required_confirmations",
      type: "integer",
      required: false,
      description: "Optional. Confirmations to wait for steps in swap. Defaults to value in coins file if not set."
    }
  ]}
/>

### TokensRequest

The `TokensRequest` object includes the following items for a given coin or token:

<CompactTable
  data={[
    {
      parameter: "ticker",
      type: "string",
      required: true,
      description: "Ticker of the token to be enabled"
    },
    {
      parameter: "required_confirmations",
      type: "integer",
      required: false,
      default: "3",
      description: "Optional, defaults to `3`. How many confirmations to wait during the transaction steps of an atomic swap. Overwrites value in coins file"
    }
  ]}
/>

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  ```json
  {
      "ticker": "MINDS-ERC20",
      "required_confirmations": 4
  }
  ```
</CollapsibleSection>

### UtxoMergeParams

The `UtxoMergeParams` object defines how often and at which thresholds to merge UTXOs. This is useful for wallets which have been used for a long time, and have many small UTXOs from mining activity.

<CompactTable
  data={[
    {
      parameter: "merge_at",
      type: "integer",
      required: true,
      description: "Mamimum UTXO count before merge loop is initiated."
    },
    {
      parameter: "check_every",
      type: "integer",
      required: true,
      description: "How frequently (in blocks) the wallet UTXO count is evaluated."
    },
    {
      parameter: "max_merge_at_once",
      type: "integer",
      required: true,
      description: "The maximum nouber of UTXOs to inlude as inputs for a merge transaction. Note that more input UTXOs means a larger transaction and greater fees, and that each blockchain has a limit to the maximum size of a transaction."
    }
  ]}
/>

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  ```json
  {
  "merge_at": 50,
  "check_every": 10,
  "max_merge_at_once": 25
  }
  ```
</CollapsibleSection>
