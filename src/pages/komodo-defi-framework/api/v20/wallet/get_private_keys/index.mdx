export const title = "Komodo DeFi Framework Method: get_private_keys";
export const description = "The get_private_keys method provides unified offline private key export for a given array of coins.";

# get\_private\_keys

The `get_private_keys` method provides unified offline private key export functionality, with optional HD support.
There are two export modes: `iguana` and `hd`. The mode to be used should match the MM2.json `enable_hd` configuration.
This method supports various coin protocols including UTXO-based coins (Bitcoin, Komodo, etc.), Ethereum-based tokens, Tendermint-based coins, and ZHTLC.

### Request Parameters

<CompactTable source="v2/wallet.GetPrivateKeysRequest" />

### Response Parameters

#### HD Mode

<CompactTable source="v2/wallet.GetPrivateKeysHdResponse" />

#### Iguana Mode

<CompactTable source="v2/wallet.GetPrivateKeysIguanaResponse" />

For detailed information about the structure fields and examples for different coin types (UTXO, ETH, ZHTLC, Tendermint), refer to the [HdKeysInfo](/komodo-defi-framework/api/common_structures/wallet/#hd-keys-info) and [IguanaKeysInfo](/komodo-defi-framework/api/common_structures/wallet/#iguana-keys-info) common structures.

<Note>
  *   This method replaces the legacy `show_priv_key`, and works with coins that are not currently activated in MM2 (as long as they are in the `coins` configuration).
  *   For HD mode, the maximum range is 100 addresses per request to prevent excessive resource usage. Make multiple requests if you need more addresses.
  *   For HD mode, keys from any account or address index are available for any coin which includes a `derivation_path` value in the `coins` configuration.
  *   ZHTLC coins like ARRR include additional `viewing_key` field in HD mode responses for enhanced privacy features.
</Note>

#### ðŸ“Œ Examples

#### Command (HD Mode)

<CodeGroup title="" tag="POST" label="get_private_keys" mm2MethodDecorate="true" source="v2/wallet.GetPrivateKeysHd" />

<KdfResponses responseKey="v2/wallet.GetPrivateKeysHd" />

#### Command (Iguana Mode)

<CodeGroup title="" tag="POST" label="get_private_keys" mm2MethodDecorate="true" source="v2/wallet.GetPrivateKeysIguana" />

<KdfResponses responseKey="v2/wallet.GetPrivateKeysIguana" />

## Error Types

| Error Type               | Description                                                              |
| ------------------------ | ------------------------------------------------------------------------ |
| HdRangeTooLarge          | `end_index` must not be > 100 higher than `start_index`                  |
| InvalidHdRange           | `start_index`must be â‰¤ `end_index`                                       |
| InvalidRequest           | `start_index`, `end_index` or `account_index` value must not be negative |
| KeyDerivationFailed      | Many causes, see examples below for more information                     |
| CoinConfigNotFound       | Requested coin does not exist in coins configuration                     |
| InvalidParametersForMode | HD-specific parameters provided when using Iguana mode                   |

<CollapsibleSection expandedText="Hide Error Responses" collapsedText="Show Error Responses">
  #### Response (Error)

  #### HdRangeTooLarge (negative index)

  When the `end_index` value is less than the `start_index` value

  ```json
  {
    "mmrpc": "2.0",
    "error": "HD index range is too large: maximum range is 100 addresses",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:672]",
    "error_type": "HdRangeTooLarge",
    "id": null
  }
  ```

  #### InvalidHdRange (negative index)

  When the `end_index` value is less than the `start_index` value

  ```json
  {
    "mmrpc": "2.0",
    "error": "HD index range is invalid: start_index 22 must be less than or equal to end_index 1",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:637]",
    "error_type": "InvalidHdRange",
    "error_data": {
        "start_index": 22,
        "end_index": 1
    },
    "id": null
  }
  ```

  #### InvalidRequest (negative index)

  When the `start_index`, `end_index` or `account_index` value is negative

  ```json
  {
    "mmrpc": "2.0",
    "error": "Error parsing request: invalid value: integer `-560`, expected u32",
    "error_path": "dispatcher",
    "error_trace": "dispatcher:125]",
    "error_type": "InvalidRequest",
    "error_data": "invalid value: integer `-560`, expected u32",
    "id": null
  }
  ```

  #### KeyDerivationFailed (index overflow)

  When the `start_index`, `end_index` or `account_index` value is too high

  ```json
  {
    "mmrpc": "2.0",
    "error": "Failed to derive keys for KMD: Invalid derivation path m/44'/141'/4294967295'/0/0: Bip32Error(ChildNumber)",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:314]",
    "error_type": "KeyDerivationFailed",
    "error_data": {
        "ticker": "KMD",
        "error": "Invalid derivation path m/44'/141'/4294967295'/0/0: Bip32Error(ChildNumber)"
    },
    "id": null
  }
  ```

  #### CoinConfigNotFound (Unsupported coin)

  When sending a query to a coin which is not present in the coins configuration file.

  ```json
  {
    "mmrpc": "2.0",
    "error": "Coin configuration not found for COVID",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:275]",
    "error_type": "CoinConfigNotFound",
    "error_data": "COVID",
    "id": null
  }
  ```

  #### KeyDerivationFailed (Unsupported coin)

  When sending a query to a coin which has no `derivation_path` defined in the coins configuration file.

  ```json
  {
    "mmrpc": "2.0",
    "error": "Failed to derive keys for BBK: Derivation path not defined for this coin. HD mode requires a valid derivation_path in the coin configuration.",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:281]",
    "error_type": "KeyDerivationFailed",
    "error_data": {
        "ticker": "BBK",
        "error": "Derivation path not defined for this coin. HD mode requires a valid derivation_path in the coin configuration."
    },
    "id": null
  }
  ```

  #### KeyDerivationFailed (wrong mode)

  When sending a query with `"mode": "hd"`, while KDF configuration is set to `"enable_hd": false`

  ```json
  {
    "mmrpc": "2.0",
    "error": "Failed to derive keys for ETH: HD key derivation requires GlobalHDAccount mode. Please initialize with HD wallet.",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:303]",
    "error_type": "KeyDerivationFailed",
    "error_data": {
        "ticker": "ETH",
        "error": "HD key derivation requires GlobalHDAccount mode. Please initialize with HD wallet."
    },
    "id": null
  }
  ```

  #### KeyDerivationFailed (wrong mode)

  When sending a query with `"mode": "iguana"`, while KDF configuration is set to `"enable_hd": true`

  ```json
  {
    "mmrpc": "2.0",
    "error": "Failed to derive keys for ARRR: Iguana key derivation requires Iguana mode",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:583]",
    "error_type": "KeyDerivationFailed",
    "error_data": {
        "ticker": "ARRR",
        "error": "Iguana key derivation requires Iguana mode"
    },
    "id": null
  }
  ```

  #### InvalidParametersForMode

  When attempting to use the `start_index`, `end_index` or `account_index` when `"mode": "iguana"`

  ```json
  {
    "mmrpc": "2.0",
    "error": "Invalid parameters: start_index and end_index are only valid for HD mode",
    "error_path": "offline_keys",
    "error_trace": "offline_keys:650]",
    "error_type": "InvalidParametersForMode",
    "id": null
  }
  ```
</CollapsibleSection>
